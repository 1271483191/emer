<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Dashboard">
    <meta name="keyword" content="Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">

    <title>粮食应急保障企业信息统计</title>
    <link rel="icon" type="image/x-icon" href="img/logo.png" />

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap.css" rel="stylesheet">
    <!--external css-->
    <link href="assets/font-awesome/css/font-awesome.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="assets/css/zabuto_calendar.css">
    <link rel="stylesheet" type="text/css" href="assets/js/gritter/css/jquery.gritter.css" />
    <link rel="stylesheet" type="text/css" href="assets/lineicons/style.css">
    <link rel="stylesheet" type="text/css" media="all" href="ztree/css/zTreeStyle.css"/>
    <link rel="stylesheet" type="text/css" media="all" href="core/treeSelect.css"/>
    <!-- ace styles -->
    <link rel="stylesheet" href="assets/css/ace.min.css"
          class="ace-main-stylesheet" id="main-ace-style" />

    <!--[if lte IE 9]>
    <link rel="stylesheet" href="assets/css/ace-part2.min.css" class="ace-main-stylesheet" />
    <![endif]-->
    <link rel="stylesheet" href="assets/css/ace-skins.min.css" />
    <link rel="stylesheet" href="assets/css/ace-rtl.min.css" />

    <link rel="stylesheet" href="assets/css/chosen.min.css" />
    <link href="assets/css/style-responsive.css" rel="stylesheet">

    <link href="assets/css/table-responsive.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="assets/css/style.css" rel="stylesheet">
    <link href="assets/css/style-responsive.css" rel="stylesheet">

    <script src="assets/js/ace-extra.min.js"></script>

    <script src="assets/js/chart-master/Chart.js"></script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <style>
        table { border-collapse: collapse;margin-top: 20px;}
        table,table tr th, table tr td { border:1px solid #000000; }
        table,table tr th{text-align: center; font-size: 1.5rem}
    </style>

</head>

<body>

<section id="container" >
    <!-- **********************************************************************************************************************************************************
    TOP BAR CONTENT & NOTIFICATIONS
    *********************************************************************************************************************************************************** -->
    <!--header start-->
    <header class="header blue-bg">
        <div class="sidebar-toggle-box">
            <div class="fa fa-bars tooltips" data-placement="right" data-original-title="Toggle Navigation"> </div>
        </div>
        <!--logo start-->
        <a href="toIndex" class="logo"><b>粮食应急保障企业信息统计</b></a>

        <div class="top-menu">
            <ul class="nav pull-right top-menu">
                <li><a class="logout" href="toLogin">注销</a></li>
            </ul>
        </div>
    </header>
    <!--header end-->

    <!-- **********************************************************************************************************************************************************
    MAIN SIDEBAR MENU
    *********************************************************************************************************************************************************** -->
    <!--sidebar start-->
    <aside>
        <div id="sidebar"  class="nav-collapse ">
            <!-- sidebar menu start-->
            <ul class="sidebar-menu" id="nav-accordion">
                <p class="logoname hidden-lg hidden-md " style="font-size: 2rem;color: white;text-align: center;font-weight: bolder">粮食应急保障企业信息统计</p>

                <p class="centered"><a href="#"><img src="assets/img/user.png" class="img-circle" width="60"></a></p>
                <h5 class="centered" th:if="${session.user == null}">未登录</h5>
                <h5 class="centered" th:if="${session.user != null}">
                    <span th:text="${session.user.getName()}"></span>
                </h5>

                <li class="mt">
                    <a href="toIndex">
                        <i class="fa fa-dashboard"></i>
                        <span style="font-size: 1.5rem">首页</span>
                    </a>
                </li>

                <li class="sub-menu">
                    <!--<a href="companysearch">-->
                    <!--<i class="fa fa-cogs"></i>-->
                    <!--<span style="font-size: 1.5rem">统计查询</span>-->
                    <!--</a>-->
                    <a href="javascript:void(0);" >
                        <i class="fa fa-book"></i>
                        <span style="font-size: 1.5rem">统计汇总</span>
                    </a>
                    <ul class="sub">
                        <li><a  href="toCountStatic" >信息统计</a></li>
                        <li><a  href="companysearch">企业搜索</a></li>

                    </ul>
                </li>
                <li class="sub-menu">
                    <a href="javascript:void(0);" >
                        <i class="fa fa-book"></i>
                        <span style="font-size: 1.5rem">应急供应网点</span>
                    </a>
                    <ul class="sub">
                        <li><a  href="toSupplyStatistics" >供应网点统计</a></li>
                        <li><a  href="toSupplyShow" >供应网点列表展示</a></li>
                        <li><a  href="toSupplyCount" >信息统计</a></li>
                    </ul>
                </li>
                <li class="sub-menu">
                    <a class="active" href="javascript:void(0);" >
                        <i class="fa fa-tasks"></i>
                        <span style="font-size: 1.5rem">应急配送中心</span>
                    </a>
                    <ul class="sub">
                        <li><a  href="toDeliverStatistics">配送中心统计</a></li>
                        <li><a  href="toDeliverShow">配送中心列表展示</a></li>
                        <li><a  href="toDeliveryCount" >信息统计</a></li>
                    </ul>
                </li>
                <li class="sub-menu">
                    <a href="javascript:void(0);" >
                        <i class="fa fa-th"></i>
                        <span style="font-size: 1.5rem">应急储运企业</span>
                    </a>
                    <ul class="sub">
                        <li><a  href="toStoreageStatistics">储运企业统计</a></li>
                        <li><a  href="toStoreageShow">储运企业列表展示</a></li>
                        <li><a  href="toStoreageCount" >信息统计</a></li>
                    </ul>
                </li>
                <li class="sub-menu">
                    <a href="javascript:void(0);" >
                        <i class=" fa fa-bar-chart-o"></i>
                        <span style="font-size: 1.5rem">应急加工企业</span>
                    </a>
                    <ul class="sub">
                        <li><a  href="toMachiningStatistics">加工企业统计</a></li>
                        <li><a  href="toMachineShow">加工企业列表展示</a></li>
                        <li><a  href="toMachineCount" >信息统计</a></li>
                    </ul>
                </li>
                <li class="sub-menu">
                    <a href="javascript:void(0);" >
                        <i class=" fa fa-bar-chart-o"></i>
                        <span style="font-size: 1.5rem">信息录入</span>
                    </a>
                    <ul class="sub">
                        <li><a  href="toSupplyInput">供应网点信息录入</a></li>
                        <li><a  href="toDeliverInput">配送中心信息录入</a></li>
                        <li><a  href="toStoreageInput">储运企业信息录入</a></li>
                        <li><a  href="toMachiningInput">加工企业信息录入</a></li>
                    </ul>
                </li>


                <li class="sub-menu">
                    <a href="javascript:void(0);" >
                        <i class="fa fa-book"></i>
                        <span style="font-size: 1.5rem">问卷信息</span>
                    </a>
                    <ul class="sub">
                        <li><a  href="toQuestionnaire">信息展示</a></li>
                    </ul>
                </li>

                <li class="sub-menu">
                    <a href="javascript:void(0);" >
                        <i class="fa fa-users"></i>
                        <span style="font-size: 1.5rem">权限管理</span>
                    </a>
                    <ul class="sub">
                        <li><a  href="toUserAdmin">个人信息</a></li>
                        <li><a  href="toUserListAdmin">用户管理</a></li>
                        <li><a  href="toJurAdmin">权限管理</a></li>
                    </ul>

                </li>

            </ul>
            <!-- sidebar menu end-->
        </div>
    </aside>
    <!--sidebar end-->

    <!-- **********************************************************************************************************************************************************
    MAIN CONTENT
    *********************************************************************************************************************************************************** -->
    <!--main content start-->
    <section id="main-content">
        <section class="wrapper">

            <div class="row">
                <div class="col-lg-12 main-chart">

                    <!--统计分析-->
                    <h3><i class="fa fa-angle-right"></i>统计分析</h3>
                    <hr>
                    <div>
                        <div class="row">
                            <div class="col-sm-12">
                                <input id="treeSelectHide" type="hidden" th:value="${promap}"/>
                                <input id="treeType" type="hidden"/>
                                <div class="treeSelect" style="width: 350px;float: left"></div>
                                <input type="button" value="查询" style="float:left;height: 24.5px;" onclick="searchTree()"/>
                            </div>
                            <!-- /.span -->
                        </div>
                    </div>
                    <div id="replaceHtml">
                        <div class="col-md-12 mb">
                            <hr>
                            <div>
                                <span th:switch="${flag}">

                                    <span th:case="true">

                                        <table  width='100%' id="supplyTable3" style="margin-top: 0px;">
                                            <tr>
                                                <th>统一社会信用代码</th>
                                                <th>实际所在地区</th>
                                                <th>实际经营地址</th>
                                                <th>经纬度</th>
                                                <th>企业性质</th>
                                                <th>应急级别</th>
                                                <th>负责人</th>
                                                <th>联系电话</th>
                                                <th colspan="3">企业指标</th>
                                            </tr>
                                            <tr>
                                                <th rowspan="2" th:text="${companyall.getSocialId()}"></th>
                                                <th rowspan="2" th:text="${companyall.getCounty()}"></th>
                                                <th rowspan="2" th:text="${companyall.getLocation()}"></th>
                                                <th rowspan="2" th:text="${companyall.getLatitude()} + ',' + ${companyall.getLongitude()}"></th>
                                                <th rowspan="2" th:text="${companyall.getActivationStatus()}"></th>
                                                <span th:switch="${companyall.getLevel()}">
                                                    <th rowspan="2" th:case="0">国家级</th>
                                                    <th rowspan="2" th:case="1">省级</th>
                                                    <th rowspan="2" th:case="2">市级</th>
                                                    <th rowspan="2" th:case="2">县级</th>
                                                </span>
                                                <th rowspan="2" th:text="${companyall.getPrincipal()}"></th>
                                                <th rowspan="2" th:text="${companyall.getPhone()}"></th>
                                                <th>日入库量</th>
                                                <th>日销量</th>
                                                <th>日库存</th>
                                            </tr>
                                            <tr>
                                                <td th:text="${companyall.getInDay()}"></td>
                                                <td th:text="${companyall.getOutDay()}"></td>
                                                <td th:text="${companyall.getSaveDay()}"></td>
                                            </tr>
                                        </table>
                                        <br>
                                        <br>
                                        <table  width='100%' id="supplyTable" style="margin-top: 0px;">
                                            <tr>
                                                <th>仓储能力</th>
                                                <th colspan="5">配送能力</th>
                                                <th>实际日供应能力（吨）</th>
                                                <th>生产状态</th>
                                            </tr>
                                            <tr>
                                                <th rowspan="2" th:text="${deliveryall.getWareAbility()}"></th>
                                                <th>日配送能力（日/天）</th>
                                                <th>辐射范围</th>
                                                <th>辐射半径（公里）</th>
                                                <th>辐射供应网点数量（个）</th>
                                                <th>运输车辆数量（个）</th>
                                                <th rowspan="2" th:text="${deliveryall.getDeliveryDayReal()}"></th>
                                                <span th:switch="${deliveryall.getState()}">
                                                    <th th:case="0" rowspan="2">未选择</th>
                                                    <th th:case="1" rowspan="2">生产</th>
                                                    <th th:case="2" rowspan="2">停产</th>
                                                </span>
                                            </tr>
                                            <tr>
                                                <td th:text="${deliveryall.getDeliveryDay()}"></td>
                                                <td th:text="${deliveryall.getRange()}"></td>
                                                <td th:text="${deliveryall.getRadius()}"></td>
                                                <td th:text="${deliveryall.getDeliveryNum()}"></td>
                                                <td th:text="${deliveryall.getCarNum()}"></td>
                                            </tr>
                                        </table>
                                    </span>


                                    <span th:case="false">
                                        <table width='100%' id="supplyTable4" style="margin-top: 0px;">
                                            <tr>
                                                <th rowspan="2"></th>
                                                <th colspan="3">企业指标</th>
                                            </tr>
                                            <tr>
                                                <th>日入库量</th>
                                                <th>日销量</th>
                                                <th>日库存</th>
                                            </tr>
                                            <tr>
                                                <td>合计</td>
                                                <td th:text="${companyall.getInDay()}"></td>
                                                <td th:text="${companyall.getOutDay()}"></td>
                                                <td th:text="${companyall.getSaveDay()}"></td>
                                            </tr>
                                        </table>
                                        <br>
                                        <br>

                                        <table width='100%' id="supplyTable2" style="margin-top: 0px;">
                                            <tr>
                                                <th rowspan="2"></th>
                                                <th rowspan="2">仓储能力</th>
                                                <th colspan="3">配送能力</th>
                                                <th rowspan="2">实际日供应能力（吨）</th>
                                            </tr>
                                            <tr>
                                                <th>日配送能力（日/天）</th>
                                                <th>辐射供应网点数量（个）</th>
                                                <th>运输车辆数量（个）</th>
                                            </tr>
                                            <tr>
                                                <th >合计</th>
                                                <th th:text="${deliveryall.getWareAbility()}"></th>
                                                <td th:text="${deliveryall.getDeliveryDay()}"></td>
                                                <td th:text="${deliveryall.getDeliveryNum()}"></td>
                                                <td th:text="${deliveryall.getCarNum()}"></td>
                                                <th th:text="${deliveryall.getDeliveryDayReal()}"></th>
                                            </tr>
                                        </table>

                                    </span>


                                </span>

                            </div>
                        </div>
                        <!--统计分析结束-->

                    </div>
                </div>
            </div>
        </section>
    </section>



    <!--main content end-->
    <!--footer start-->
    <footer class="site-footer">
        <div class="text-center">
            2020.<a href="http://www.lswz.gov.cn" target="_blank">国家粮食和物质储备局</a>
        </div>
    </footer>
    <!--footer end-->
</section>

<!-- js placed at the end of the document so the pages load faster -->
<script src="assets/js/jquery.js"></script>
<script src="assets/js/jquery-1.8.3.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script class="include" type="text/javascript" src="assets/js/jquery.dcjqaccordion.2.7.js"></script>
<script src="assets/js/jquery.scrollTo.min.js"></script>
<script src="assets/js/jquery.nicescroll.js" type="text/javascript"></script>
<script src="assets/js/jquery.sparkline.js"></script>
<script src="ztree/js/jquery.ztree.all.min.js"></script>
<script src="core/treeSelect.js"></script>

<script src="assets/js/jquery.dataTables.min.js"></script>
<script src="assets/js/jquery.dataTables.bootstrap.min.js"></script>
<script src="assets/js/dataTables.buttons.min.js"></script>
<script src="assets/js/buttons.flash.min.js"></script>
<script src="assets/js/buttons.html5.min.js"></script>
<script src="assets/js/buttons.print.min.js"></script>
<script src="assets/js/buttons.colVis.min.js"></script>
<script src="assets/js/dataTables.select.min.js"></script>

<script src="assets/js/jquery-ui.custom.min.js"></script>
<script src="assets/js/jquery.ui.touch-punch.min.js"></script>
<script src="assets/js/chosen.jquery.min.js"></script>

<!--<script src="js/search.js"></script>-->
<!--common script for all pages-->
<script src="assets/js/common-scripts.js"></script>

<script type="text/javascript" src="assets/js/gritter/js/jquery.gritter.js"></script>
<script type="text/javascript" src="assets/js/gritter-conf.js"></script>

<!--script for this page-->
<script src="assets/js/sparkline-chart.js"></script>
<script src="assets/js/zabuto_calendar.js"></script>
<script type="application/javascript">

    /*$.post("toTreelist",function(treedata){$(function () {
     data = eval('(' + treedata + ')')
     $(".treeSelect").treeSelect({
     data:data,
     inputId:"txt"
     })
     });});*/

    console.log($("#treeSelectHide").val());

    data = eval('(' + $("#treeSelectHide").val() + ')');
    $(".treeSelect").treeSelect({
        data:data,
        inputId:"txt"
    })

    function searchTree(){
        var promap = $("#treeSelectHide").val();
        var level = $("#treeType").val();
        var txt = $("#txt").val();

        //点击省市县区不执行任何操作，只有点击企业才会去查询相关企业信息
        //if(level != "3") return;

        console.log("promap:"+promap);
        console.log("level:"+level);
        console.log("txt:"+txt);
        if(txt==null || txt==""){
            return;
        }

        var temp = document.createElement("form");
        temp.action = "/toDeliveryTreeSaerch";
        temp.method = "post";
        temp.style.display = "none";

        var opt1 = document.createElement("textarea");
        opt1.name = "promap";
        opt1.value = promap;
        // alert(opt.name)
        temp.appendChild(opt1);

        var opt2 = document.createElement("textarea");
        opt2.name = "level";
        opt2.value = level;
        // alert(opt.name)
        temp.appendChild(opt2);

        var opt3 = document.createElement("textarea");
        opt3.name = "txt";
        opt3.value = txt;
        // alert(opt.name)
        temp.appendChild(opt3);

        document.body.appendChild(temp);
        temp.submit();



        /*$.post("/toSupplyTreeSaerch",
            {
                level:level,txt:txt,promap:promap
            },
            function(data,status){

                console.log("success")
                /!*var curWwwPath=window.document.location.href;
                var pathName=window.document.location.pathname;
                var localhostPaht;
                var pos = curWwwPath.indexOf(pathName);
                localhostPaht = curWwwPath.substring(0,pos);
                localhostPaht += "/";
                var href = localhostPaht + "toSupplyTreeSaerch?level=" + level + "&txt=" + txt + "&promap=" + promap;
                console.log(href);
                window.location.href = href;*!/
            });*/

        /*$.ajax({
            type: "POST",
            url: "toSupplyTreeSaerch",
            data: {level:level,txt:txt},
            async:false,
            success: function(data){
                $("#replaceHtml").html($(data).find("#replaceHtml").html());
                var myTable = $('#dynamic-table')
                    .DataTable( {
                        destroy : true,
                        scrollX: true,
                        scrollCollapse: true,
                        bPaginate: true,
                        language: {
                            "sProcessing": "处理中...",
                            "sLengthMenu": "显示 _MENU_ 项结果",
                            "sZeroRecords": "没有匹配结果",
                            "sInfo": "显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",
                            "sInfoEmpty": "显示第 0 至 0 项结果，共 0 项",
                            "sInfoFiltered": "(由 _MAX_ 项结果过滤)",
                            "sInfoPostFix": "",
                            "sSearch": "搜索:",
                            "sUrl": "",
                            "sEmptyTable": "表中数据为空",
                            "sLoadingRecords": "载入中...",
                            "sInfoThousands": ",",
                            "oPaginate": {
                                "sFirst": "首页",
                                "sPrevious": "上页",
                                "sNext": "下页",
                                "sLast": "末页"
                            },
                            "oAria": {
                                "sSortAscending": ": 以升序排列此列",
                                "sSortDescending": ": 以降序排列此列"
                            }
                        },
                        bAutoWidth: false,
                        "aoColumns": [
                            { "bSortable": false },
                            null, null,null, null, null,null,null
                        ],
                        "aaSorting": [],
                        select: {
                            style: 'multi'
                        }
                    } );
                $.fn.dataTable.Buttons.defaults.dom.container.className = 'dt-buttons btn-overlap btn-group btn-overlap';

                new $.fn.dataTable.Buttons( myTable, {
                    buttons: [
                        {
                            "extend": "colvis",
                            "text": "<i class='fa fa-search bigger-110 blue'></i> <span class='hidden'>展示/隐藏 列名</span>",
                            "className": "btn btn-white btn-primary btn-bold",
                            columns: ':not(:first)'
                        },
                        {
                            "extend": "copy",
                            "text": "<i class='fa fa-copy bigger-110 pink'></i> <span class='hidden'>复制到剪贴板</span>",
                            "className": "btn btn-white btn-primary btn-bold"
                        },
                        {
                            "extend": "csv",
                            "text": "<i class='fa fa-database bigger-110 orange'></i> <span class='hidden'>导出CSV文件</span>",
                            "className": "btn btn-white btn-primary btn-bold",
                            "sCharSet": "utf16le",
                            "bBomInc": true,
                            "sFieldSeperator": "\t"
                        },
                        // {
                        //     "extend": "excel",
                        //     "text": "<i class='fa fa-file-excel-o bigger-110 green'></i> <span class='hidden'>导出Excel文件</span>",
                        //     "className": "btn btn-white btn-primary btn-bold"
                        // },
                        {
                            "extend": "print",
                            "text": "<i class='fa fa-print bigger-110 grey'></i> <span class='hidden'>打印</span>",
                            "className": "btn btn-white btn-primary btn-bold",
                            autoPrint: false,
                            message: 'This print was produced using the Print button for DataTables'
                        }
                    ]
                } );
                myTable.buttons().container().appendTo( $('.tableTools-container') );

                //style the message box
                var defaultCopyAction = myTable.button(1).action();
                myTable.button(1).action(function (e, dt, button, config) {
                    defaultCopyAction(e, dt, button, config);
                    $('.dt-button-info').addClass('gritter-item-wrapper gritter-info gritter-center white');
                });


                var defaultColvisAction = myTable.button(0).action();
                myTable.button(0).action(function (e, dt, button, config) {

                    defaultColvisAction(e, dt, button, config);


                    if($('.dt-button-collection > .dropdown-menu').length == 0) {
                        $('.dt-button-collection')
                            .wrapInner('<ul class="dropdown-menu dropdown-light dropdown-caret dropdown-caret" />')
                            .find('a').attr('href', '#').wrap("<li />")
                    }
                    $('.dt-button-collection').appendTo('.tableTools-container .dt-buttons')
                });

                setTimeout(function() {
                    $($('.tableTools-container')).find('a.dt-button').each(function() {
                        var div = $(this).find(' > div').first();
                        if(div.length == 1) div.tooltip({container: 'body', title: div.parent().text()});
                        else $(this).tooltip({container: 'body', title: $(this).text()});
                    });
                }, 500);

                myTable.on( 'select', function ( e, dt, type, index ) {
                    if ( type === 'row' ) {
                        $( myTable.row( index ).node() ).find('input:checkbox').prop('checked', true);
                    }
                } );
                myTable.on( 'deselect', function ( e, dt, type, index ) {
                    if ( type === 'row' ) {
                        $( myTable.row( index ).node() ).find('input:checkbox').prop('checked', false);
                    }
                } );

                //table checkboxes
                $('th input[type=checkbox], td input[type=checkbox]').prop('checked', false);

                //select/deselect all rows according to table header checkbox
                $('#dynamic-table > thead > tr > th input[type=checkbox], #dynamic-table_wrapper input[type=checkbox]').eq(-1).on('click', function(){
                    var th_checked = this.checked;//checkbox inside "TH" table header
                    $('#dynamic-table').find('tbody > tr').each(function(){
                        var row = this;
                        if(th_checked) myTable.row(row).select();
                        else  myTable.row(row).deselect();
                    });
                });

            }

        });*/
    }

    $(document).ready(function () {
        $("#date-popover").popover({html: true, trigger: "manual"});
        $("#date-popover").hide();
        $("#date-popover").click(function (e) {
            $(this).hide();
        });

        $("#my-calendar").zabuto_calendar({
            action: function () {
                return myDateFunction(this.id, false);
            },
            action_nav: function () {
                return myNavFunction(this.id);
            },
            ajax: {
                url: "show_data.php?action=1",
                modal: true
            },
            legend: [
                {type: "text", label: "Special event", badge: "00"},
                {type: "block", label: "Regular event", }
            ]
        });
    });


    function myNavFunction(id) {
        $("#date-popover").hide();
        var nav = $("#" + id).data("navigation");
        var to = $("#" + id).data("to");
        console.log('nav ' + nav + ' to: ' + to.month + '/' + to.year);
    }
</script>


</body>
</html>
